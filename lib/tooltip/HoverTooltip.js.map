{"version":3,"sources":["../../../src/lib/tooltip/HoverTooltip.js"],"names":["HoverTooltip","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","pointer","helper","height","context","bgFill","bgOpacity","backgroundShapeSVG","tooltipSVG","bgheight","bgwidth","x","y","content","centerX","pointWidth","bgSize","bgShape","width","Component","propTypes","chartId","PropTypes","oneOfType","number","string","yAccessor","func","isRequired","tooltipContent","origin","array","fontFamily","fontSize","contextTypes","margin","object","ratio","defaultProps","tooltipCanvas","fill","stroke","fontFill","opacity","backgroundShapeCanvas","PADDING","X","Y","tspans","startY","i","length","textY","push","label","value","fillStyle","strokeStyle","beginPath","rect","font","textAlign","fillText","measureText","originX","left","originY","top","save","setTransform","scale","translate","restore","calculateTooltipSize","canvas","document","createElement","getContext","str","map","reduce","res","size","sumSizes","String","sizes","Math","max","d","normalizeX","normalizeY","mouseXY","xAccessor","currentItem","xScale","chartConfig","xValue","round","findIndex","yValue","chartIndex","id","yScale","show","plotData","displayXAccessor","abs"],"mappings":";;;;;;;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;AAEA;;;;;;;;;;;;IAEMA,Y;;;AACL,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA,0HACZA,KADY;;AAElB,QAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,OAAjB;AACA,QAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,OAApB;AAHkB;AAIlB;;;;+BACYE,G,EAAKC,S,EAAW;AAC5B,OAAMC,UAAUC,OAAO,KAAKP,KAAZ,EAAmBK,SAAnB,EAA8BD,GAA9B,CAAhB;AAD4B,OAEpBI,MAFoB,GAETH,SAFS,CAEpBG,MAFoB;;;AAI5B,OAAI,yBAAaF,OAAb,CAAJ,EAA2B,OAAO,IAAP;AAC3BH,iBAAaC,GAAb,EAAkB,KAAKJ,KAAvB,EAA8B,KAAKS,OAAnC,EAA4CH,OAA5C,EAAqDE,MAArD,EAA6DH,SAA7D;AACA;;;2BACQ;AACR,UAAO,8BAAC,0BAAD;AACN,aAAS,KAAKJ,SADR;AAEN,gBAAY,KAAKE,YAFX;AAGN,YAAQ,CAAC,WAAD,EAAc,KAAd,CAAmB,oBAAnB;AAHF,KAAP;AAKA;;;4BACSE,S,EAAW;AACpB,OAAMC,UAAUC,OAAO,KAAKP,KAAZ,EAAmBK,SAAnB,CAAhB;;AAEA,OAAI,yBAAaC,OAAb,CAAJ,EAA2B,OAAO,IAAP;;AAHP,gBAK0C,KAAKN,KAL/C;AAAA,OAKZU,MALY,UAKZA,MALY;AAAA,OAKJC,SALI,UAKJA,SALI;AAAA,OAKOC,kBALP,UAKOA,kBALP;AAAA,OAK2BC,UAL3B,UAK2BA,UAL3B;AAAA,iBAMU,KAAKb,KANf;AAAA,OAMZc,QANY,WAMZA,QANY;AAAA,OAMFC,OANE,WAMFA,OANE;AAAA,OAOZP,MAPY,GAODH,SAPC,CAOZG,MAPY;AAAA,OASZQ,CATY,GASmCV,OATnC,CASZU,CATY;AAAA,OASTC,CATS,GASmCX,OATnC,CASTW,CATS;AAAA,OASNC,OATM,GASmCZ,OATnC,CASNY,OATM;AAAA,OASGC,OATH,GASmCb,OATnC,CASGa,OATH;AAAA,OASYC,UATZ,GASmCd,OATnC,CASYc,UATZ;AAAA,OASwBC,MATxB,GASmCf,OATnC,CASwBe,MATxB;;;AAWpB,OAAMC,UAAU,sBAAUP,OAAV,KAAsB,sBAAUD,QAAV,CAAtB,GACb,EAAES,OAAOR,OAAT,EAAkBP,QAAQM,QAA1B,EADa,GAEbO,MAFH;;AAIA,UACC;AAAA;AAAA;AACC,4CAAM,GAAGF,UAAUC,aAAa,CAAhC;AACC,QAAG,CADJ;AAEC,YAAOA,UAFR;AAGC,aAAQZ,MAHT;AAIC,WAAME,MAJP;AAKC,cAASC,SALV,GADD;AAOC;AAAA;AAAA,OAAG,WAAU,mCAAb,EAAiD,0BAAwBK,CAAxB,UAA8BC,CAA9B,MAAjD;AACEL,wBAAmB,KAAKZ,KAAxB,EAA+BsB,OAA/B,CADF;AAEET,gBAAW,KAAKb,KAAhB,EAAuBkB,OAAvB;AAFF;AAPD,IADD;AAcA;;;;EAjDyBM,gB;;AAoD3BzB,aAAa0B,SAAb,GAAyB;AACxBC,UAASC,oBAAUC,SAAV,CAAoB,CAACD,oBAAUE,MAAX,EAAmBF,oBAAUG,MAA7B,CAApB,CADe;AAExBC,YAAWJ,oBAAUK,IAFG;AAGxBnB,aAAYc,oBAAUK,IAHE;AAIxBpB,qBAAoBe,oBAAUK,IAJN;AAKxBjB,UAASY,oBAAUE,MALK;AAMxBf,WAAUa,oBAAUE,MANI;AAOxBnB,SAAQiB,oBAAUG,MAAV,CAAiBG,UAPD;AAQxBtB,YAAWgB,oBAAUE,MAAV,CAAiBI,UARJ;AASxBC,iBAAgBP,oBAAUK,IAAV,CAAeC,UATP;AAUxBE,SAAQR,oBAAUC,SAAV,CAAoB,CAC3BD,oBAAUS,KADiB,EAE3BT,oBAAUK,IAFiB,CAApB,EAGLC,UAbqB;AAcxBI,aAAYV,oBAAUG,MAdE;AAexBQ,WAAUX,oBAAUE;AAfI,CAAzB;;AAkBA9B,aAAawC,YAAb,GAA4B;AAC3BC,SAAQb,oBAAUc,MAAV,CAAiBR,UADE;AAE3BS,QAAOf,oBAAUE,MAAV,CAAiBI;AAFG,CAA5B;;AAKAlC,aAAa4C,YAAb,GAA4B;AAC3B;AACA;AACA9B,aAAYA,UAHe;AAI3B+B,gBAAeA,aAJY;AAK3BT,SAAQA,MALmB;AAM3BU,OAAM,SANqB;AAO3BnC,SAAQ,SAPmB;AAQ3BC,YAAW,GARgB;AAS3BmC,SAAQ,SATmB;AAU3BC,WAAU,SAViB;AAW3BC,UAAS,GAXkB;AAY3BpC,qBAAoBA,kBAZO;AAa3BqC,wBAAuBA,qBAbI;AAc3BZ,aAAY,8CAde;AAe3BC,WAAU;AAfiB,CAA5B;;AAkBA,IAAMY,UAAU,CAAhB;AACA,IAAMC,IAAI,EAAV;AACA,IAAMC,IAAI,EAAV;;AAGA;AACA,SAASxC,kBAAT,cAA0E;AAAA,KAA5CiC,IAA4C,QAA5CA,IAA4C;AAAA,KAAtCC,MAAsC,QAAtCA,MAAsC;AAAA,KAA9BE,OAA8B,QAA9BA,OAA8B;AAAA,KAAjBxC,MAAiB,SAAjBA,MAAiB;AAAA,KAATe,KAAS,SAATA,KAAS;;AACzE,QAAO;AACN,UAAQf,MADF;AAEN,SAAOe,KAFD;AAGN,QAAMsB,IAHA;AAIN,WAASG,OAJH;AAKN,UAAQF,MALF,GAAP;AAMA;;AAED,SAASjC,UAAT,QAAwDK,OAAxD,EAAiE;AAAA,KAA3CmB,UAA2C,SAA3CA,UAA2C;AAAA,KAA/BC,QAA+B,SAA/BA,QAA+B;AAAA,KAArBS,QAAqB,SAArBA,QAAqB;;AAChE,KAAMM,SAAS,EAAf;AACA,KAAMC,SAASF,IAAId,WAAW,GAA9B;;AAEA,MAAK,IAAIiB,IAAI,CAAb,EAAgBA,IAAIrC,QAAQD,CAAR,CAAUuC,MAA9B,EAAsCD,GAAtC,EAA2C;AAC1C,MAAMtC,IAAIC,QAAQD,CAAR,CAAUsC,CAAV,CAAV;AACA,MAAME,QAAQH,SAAUhB,YAAYiB,IAAI,CAAhB,CAAxB;;AAEAF,SAAOK,IAAP,CAAY;AAAA;AAAA,KAAO,YAAUH,CAAjB,EAAsB,GAAGJ,CAAzB,EAA4B,GAAGM,KAA/B,EAAsC,MAAMxC,EAAE6B,MAA9C;AAAuD7B,KAAE0C;AAAzD,GAAZ;AACAN,SAAOK,IAAP,CAAY;AAAA;AAAA,KAAO,KAAKH,CAAZ;AAAA;AAAA,GAAZ;AACAF,SAAOK,IAAP,CAAY;AAAA;AAAA,KAAO,YAAUH,CAAjB;AAAuBtC,KAAE2C;AAAzB,GAAZ;AACA;AACD,QAAO;AAAA;AAAA,IAAM,YAAYvB,UAAlB,EAA8B,UAAUC,QAAxC,EAAkD,MAAMS,QAAxD;AACN;AAAA;AAAA,KAAO,GAAGI,CAAV,EAAa,GAAGG,MAAhB;AAAyBpC,WAAQF;AAAjC,GADM;AAELqC;AAFK,EAAP;AAIA;AACD;;AAEA,SAASJ,qBAAT,CAA+BjD,KAA/B,SAAyDI,GAAzD,EAA8D;AAAA,KAAtBmB,KAAsB,SAAtBA,KAAsB;AAAA,KAAff,MAAe,SAAfA,MAAe;AAAA,KACrDqC,IADqD,GAC3B7C,KAD2B,CACrD6C,IADqD;AAAA,KAC/CC,MAD+C,GAC3B9C,KAD2B,CAC/C8C,MAD+C;AAAA,KACvCE,OADuC,GAC3BhD,KAD2B,CACvCgD,OADuC;;;AAG7D5C,KAAIyD,SAAJ,GAAgB,sBAAUhB,IAAV,EAAgBG,OAAhB,CAAhB;AACA5C,KAAI0D,WAAJ,GAAkBhB,MAAlB;AACA1C,KAAI2D,SAAJ;AACA3D,KAAI4D,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAezC,KAAf,EAAsBf,MAAtB;AACAJ,KAAIyC,IAAJ;AACAzC,KAAI0C,MAAJ;AACA;;AAED,SAASF,aAAT,QAA2D1B,OAA3D,EAAoEd,GAApE,EAAyE;AAAA,KAAhDiC,UAAgD,SAAhDA,UAAgD;AAAA,KAApCC,QAAoC,SAApCA,QAAoC;AAAA,KAA1BS,QAA0B,SAA1BA,QAA0B;;AACxE,KAAMO,SAASF,IAAId,WAAW,GAA9B;AACAlC,KAAI6D,IAAJ,GAAc3B,QAAd,WAA4BD,UAA5B;AACAjC,KAAIyD,SAAJ,GAAgBd,QAAhB;AACA3C,KAAI8D,SAAJ,GAAgB,MAAhB;AACA9D,KAAI+D,QAAJ,CAAajD,QAAQF,CAArB,EAAwBmC,CAAxB,EAA2BG,MAA3B;;AAEA,MAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIrC,QAAQD,CAAR,CAAUuC,MAA9B,EAAsCD,GAAtC,EAA2C;AAC1C,MAAMtC,IAAIC,QAAQD,CAAR,CAAUsC,CAAV,CAAV;AACA,MAAME,QAAQH,SAAUhB,YAAYiB,IAAI,CAAhB,CAAxB;AACAnD,MAAIyD,SAAJ,GAAgB5C,EAAE6B,MAAF,IAAYC,QAA5B;AACA3C,MAAI+D,QAAJ,CAAalD,EAAE0C,KAAf,EAAsBR,CAAtB,EAAyBM,KAAzB;;AAEArD,MAAIyD,SAAJ,GAAgBd,QAAhB;AACA3C,MAAI+D,QAAJ,CAAa,OAAOlD,EAAE2C,KAAtB,EAA6BT,IAAI/C,IAAIgE,WAAJ,CAAgBnD,EAAE0C,KAAlB,EAAyBpC,KAA1D,EAAiEkC,KAAjE;AACA;AACD;;AAED,SAAStD,aAAT,CAAsBC,GAAtB,EAA2BJ,KAA3B,EAAkCS,OAAlC,EAA2CH,OAA3C,EAAoDE,MAApD,EAA4D;AAAA,KAEnDgC,MAFmD,GAEjC/B,OAFiC,CAEnD+B,MAFmD;AAAA,KAE3CE,KAF2C,GAEjCjC,OAFiC,CAE3CiC,KAF2C;AAAA,KAGnDhC,MAHmD,GAG7BV,KAH6B,CAGnDU,MAHmD;AAAA,KAG3CC,SAH2C,GAG7BX,KAH6B,CAG3CW,SAH2C;AAAA,KAInDsC,qBAJmD,GAIVjD,KAJU,CAInDiD,qBAJmD;AAAA,KAI5BL,aAJ4B,GAIV5C,KAJU,CAI5B4C,aAJ4B;;;AAM3D,KAAMyB,UAAU,MAAM3B,KAAN,GAAcF,OAAO8B,IAArC;AACA,KAAMC,UAAU,MAAM7B,KAAN,GAAcF,OAAOgC,GAArC;;AAEApE,KAAIqE,IAAJ;;AAEArE,KAAIsE,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC;AACAtE,KAAIuE,KAAJ,CAAUjC,KAAV,EAAiBA,KAAjB;;AAEAtC,KAAIwE,SAAJ,CAAcP,OAAd,EAAuBE,OAAvB;;AAd2D,KAgBnDvD,CAhBmD,GAgBJV,OAhBI,CAgBnDU,CAhBmD;AAAA,KAgBhDC,CAhBgD,GAgBJX,OAhBI,CAgBhDW,CAhBgD;AAAA,KAgB7CC,OAhB6C,GAgBJZ,OAhBI,CAgB7CY,OAhB6C;AAAA,KAgBpCC,OAhBoC,GAgBJb,OAhBI,CAgBpCa,OAhBoC;AAAA,KAgB3BC,UAhB2B,GAgBJd,OAhBI,CAgB3Bc,UAhB2B;AAAA,KAgBfC,MAhBe,GAgBJf,OAhBI,CAgBfe,MAhBe;;;AAkB3DjB,KAAIyD,SAAJ,GAAgB,sBAAUnD,MAAV,EAAkBC,SAAlB,CAAhB;AACAP,KAAI2D,SAAJ;AACA3D,KAAI4D,IAAJ,CAAS7C,UAAUC,aAAa,CAAhC,EAAmC,CAAnC,EAAsCA,UAAtC,EAAkDZ,MAAlD;AACAJ,KAAIyC,IAAJ;;AAEAzC,KAAIwE,SAAJ,CAAc5D,CAAd,EAAiBC,CAAjB;AACAgC,uBAAsBjD,KAAtB,EAA6BqB,MAA7B,EAAqCjB,GAArC;AACAwC,eAAc5C,KAAd,EAAqBkB,OAArB,EAA8Bd,GAA9B;;AAEAA,KAAIyE,OAAJ;AACA;;AAED,SAASC,oBAAT,QAAkE5D,OAAlE,EAA2Ed,GAA3E,EAAgF;AAAA,KAAhDiC,UAAgD,SAAhDA,UAAgD;AAAA,KAApCC,QAAoC,SAApCA,QAAoC;AAAA,KAA1BS,QAA0B,SAA1BA,QAA0B;;AAC/E,KAAI,yBAAa3C,GAAb,CAAJ,EAAuB;AACtB,MAAM2E,SAASC,SAASC,aAAT,CAAuB,QAAvB,CAAf;AACA7E,QAAM2E,OAAOG,UAAP,CAAkB,IAAlB,CAAN;AACA;;AAED9E,KAAI6D,IAAJ,GAAc3B,QAAd,WAA4BD,UAA5B;AACAjC,KAAIyD,SAAJ,GAAgBd,QAAhB;AACA3C,KAAI8D,SAAJ,GAAgB,MAAhB;;AAEA,KAAME,cAAc,SAAdA,WAAc;AAAA,SAAQ;AAC3B7C,UAAOnB,IAAIgE,WAAJ,CAAgBe,GAAhB,EAAqB5D,KADD;AAE3Bf,WAAQ8B;AAFmB,GAAR;AAAA,EAApB;;AAV+E,6BAerDpB,QAAQD,CAAR,CACxBmE,GADwB,CACpB;AAAA,MAAGzB,KAAH,SAAGA,KAAH;AAAA,MAAUC,KAAV,SAAUA,KAAV;AAAA,SAAsBQ,YAAeT,KAAf,UAAyBC,KAAzB,CAAtB;AAAA,EADoB;AAEzB;AAFyB,EAGxByB,MAHwB,CAGjB,UAACC,GAAD,EAAMC,IAAN;AAAA,SAAeC,SAASF,GAAT,EAAcC,IAAd,CAAf;AAAA,EAHiB,EAGmBnB,YAAYqB,OAAOvE,QAAQF,CAAf,CAAZ,CAHnB,CAfqD;AAAA,KAevEO,KAfuE,yBAevEA,KAfuE;AAAA,KAehEf,MAfgE,yBAehEA,MAfgE;;AAqB/E,QAAO;AACNe,SAAOA,QAAQ,IAAI4B,CADb;AAEN3C,UAAQA,SAAS,IAAI4C;AAFf,EAAP;AAIA;;AAED,SAASoC,QAAT,GAA4B;AAAA,mCAAPE,KAAO;AAAPA,OAAO;AAAA;;AAC3B,QAAO;AACNnE,SAAOoE,KAAKC,GAAL,gCAAYF,MAAMN,GAAN,CAAU;AAAA,UAAQG,KAAKhE,KAAb;AAAA,GAAV,CAAZ,EADD;AAENf,UAAQ,kBAAIkF,KAAJ,EAAW;AAAA,UAAKG,EAAErF,MAAP;AAAA,GAAX;AAFF,EAAP;AAIA;;AAED,SAASsF,UAAT,CAAoB9E,CAApB,EAAuBK,MAAvB,EAA+BD,UAA/B,EAA2CG,KAA3C,EAAkD;AACjD;AACA,QAAOP,IAAIO,QAAQ,CAAZ,GACJP,IAAII,aAAa,CAAjB,GAAqB8B,OADjB,GAEJlC,IAAIK,OAAOE,KAAX,GAAmBH,aAAa,CAAhC,GAAoC8B,OAFvC;AAGA;;AAED,SAAS6C,UAAT,CAAoB9E,CAApB,EAAuBI,MAAvB,EAA+B;AAC9B,QAAOJ,IAAII,OAAOb,MAAX,IAAqB,CAArB,GACJS,IAAIiC,OADA,GAEJjC,IAAII,OAAOb,MAAX,GAAoB0C,OAFvB;AAGA;;AAED,SAASf,MAAT,CAAgBnC,KAAhB,EAAuBK,SAAvB,EAAkCgB,MAAlC,EAA0CD,UAA1C,EAAsD;AAAA,KAC7CM,OAD6C,GACtB1B,KADsB,CAC7C0B,OAD6C;AAAA,KACpCK,SADoC,GACtB/B,KADsB,CACpC+B,SADoC;AAAA,KAE7CiE,OAF6C,GAEmB3F,SAFnB,CAE7C2F,OAF6C;AAAA,KAEpCC,SAFoC,GAEmB5F,SAFnB,CAEpC4F,SAFoC;AAAA,KAEzBC,WAFyB,GAEmB7F,SAFnB,CAEzB6F,WAFyB;AAAA,KAEZC,MAFY,GAEmB9F,SAFnB,CAEZ8F,MAFY;AAAA,KAEJC,WAFI,GAEmB/F,SAFnB,CAEJ+F,WAFI;AAAA,KAES7E,KAFT,GAEmBlB,SAFnB,CAESkB,KAFT;;AAGrD,KAAIN,IAAI,iBAAK+E,OAAL,CAAR;;AAEA,KAAMK,SAASJ,UAAUC,WAAV,CAAf;AACA,KAAIlF,IAAI2E,KAAKW,KAAL,CAAWH,OAAOE,MAAP,CAAX,CAAR;;AAEA,KAAI,sBAAU3E,OAAV,KAAsB,sBAAUK,SAAV,CAAtB,IACC,sBAAUqE,WAAV,CADD,IAC2B,sBAAUA,YAAYG,SAAtB,CAD/B,EACiE;AAChE,MAAMC,SAASzE,UAAUmE,WAAV,CAAf;AACA,MAAMO,aAAaL,YAAYG,SAAZ,CAAsB;AAAA,UAAKvF,EAAE0F,EAAF,KAAShF,OAAd;AAAA,GAAtB,CAAnB;;AAEAT,MAAI0E,KAAKW,KAAL,CAAWF,YAAYK,UAAZ,EAAwBE,MAAxB,CAA+BH,MAA/B,CAAX,CAAJ;AACA;;AAEDxF,KAAI8E,WAAW9E,CAAX,EAAcK,MAAd,EAAsBD,UAAtB,EAAkCG,KAAlC,CAAJ;AACAN,KAAI8E,WAAW9E,CAAX,EAAcI,MAAd,CAAJ;;AAEA,QAAO,CAACL,CAAD,EAAIC,CAAJ,CAAP;AACA;;AAED,SAASV,MAAT,CAAgBP,KAAhB,EAAuBK,SAAvB,EAAkCD,GAAlC,EAAuC;AAAA,KAC9BwG,IAD8B,GACUvG,SADV,CAC9BuG,IAD8B;AAAA,KACxBT,MADwB,GACU9F,SADV,CACxB8F,MADwB;AAAA,KAChBD,WADgB,GACU7F,SADV,CAChB6F,WADgB;AAAA,KACHW,QADG,GACUxG,SADV,CACHwG,QADG;AAAA,KAE9B1E,MAF8B,GAEHnC,KAFG,CAE9BmC,MAF8B;AAAA,KAEtBD,cAFsB,GAEHlC,KAFG,CAEtBkC,cAFsB;AAAA,KAG9B+D,SAH8B,GAGE5F,SAHF,CAG9B4F,SAH8B;AAAA,KAGnBa,gBAHmB,GAGEzG,SAHF,CAGnByG,gBAHmB;;;AAKtC,KAAI,CAACF,IAAD,IAAS,yBAAaV,WAAb,CAAb,EAAwC;;AAExC,KAAMG,SAASJ,UAAUC,WAAV,CAAf;;AAEA,KAAI,CAACU,IAAD,IAAS,yBAAaP,MAAb,CAAb,EAAmC;;AAEnC,KAAMnF,UAAUgB,eAAe,EAAEgE,wBAAF,EAAeD,WAAWa,gBAA1B,EAAf,CAAhB;AACA,KAAM3F,UAAUgF,OAAOE,MAAP,CAAhB;AACA,KAAMjF,aAAauE,KAAKoB,GAAL,CAASZ,OAAOF,UAAU,iBAAKY,QAAL,CAAV,CAAP,IAAoCV,OAAOF,UAAU,kBAAMY,QAAN,CAAV,CAAP,CAA7C,KAAoFA,SAASrD,MAAT,GAAkB,CAAtG,CAAnB;;AAEA,KAAMnC,SAASyD,qBAAqB9E,KAArB,EAA4BkB,OAA5B,EAAqCd,GAArC,CAAf;;AAfsC,eAiBvB+B,OAAOnC,KAAP,EAAcK,SAAd,EAAyBgB,MAAzB,EAAiCD,UAAjC,CAjBuB;AAAA;AAAA,KAiB/BJ,CAjB+B;AAAA,KAiB5BC,CAjB4B;;AAmBtC,QAAO,EAAED,IAAF,EAAKC,IAAL,EAAQC,gBAAR,EAAiBC,gBAAjB,EAA0BC,sBAA1B,EAAsCC,cAAtC,EAAP;AACA;;kBAEctB,Y","file":"HoverTooltip.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent from \"../GenericComponent\";\nimport { sum } from \"d3-array\";\n\nimport { first, last, isNotDefined, isDefined, hexToRGBA } from \"../utils\";\n\nclass HoverTooltip extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst pointer = helper(this.props, moreProps, ctx);\n\t\tconst { height } = moreProps;\n\n\t\tif (isNotDefined(pointer)) return null;\n\t\tdrawOnCanvas(ctx, this.props, this.context, pointer, height, moreProps);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tdrawOn={[\"mousemove\", \"pan\"/* , \"mouseleave\" */]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst pointer = helper(this.props, moreProps);\n\n\t\tif (isNotDefined(pointer)) return null;\n\n\t\tconst { bgFill, bgOpacity, backgroundShapeSVG, tooltipSVG } = this.props;\n\t\tconst { bgheight, bgwidth } = this.props;\n\t\tconst { height } = moreProps;\n\n\t\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\n\n\t\tconst bgShape = isDefined(bgwidth) && isDefined(bgheight)\n\t\t\t? { width: bgwidth, height: bgheight }\n\t\t\t: bgSize;\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t<rect x={centerX - pointWidth / 2}\n\t\t\t\t\ty={0}\n\t\t\t\t\twidth={pointWidth}\n\t\t\t\t\theight={height}\n\t\t\t\t\tfill={bgFill}\n\t\t\t\t\topacity={bgOpacity} />\n\t\t\t\t<g className=\"react-stockcharts-tooltip-content\" transform={`translate(${x}, ${y})`}>\n\t\t\t\t\t{backgroundShapeSVG(this.props, bgShape)}\n\t\t\t\t\t{tooltipSVG(this.props, content)}\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t);\n\t}\n}\n\nHoverTooltip.propTypes = {\n\tchartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n\tyAccessor: PropTypes.func,\n\ttooltipSVG: PropTypes.func,\n\tbackgroundShapeSVG: PropTypes.func,\n\tbgwidth: PropTypes.number,\n\tbgheight: PropTypes.number,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\ttooltipContent: PropTypes.func.isRequired,\n\torigin: PropTypes.oneOfType([\n\t\tPropTypes.array,\n\t\tPropTypes.func\n\t]).isRequired,\n\tfontFamily: PropTypes.string,\n\tfontSize: PropTypes.number,\n};\n\nHoverTooltip.contextTypes = {\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n};\n\nHoverTooltip.defaultProps = {\n\t// bgwidth: 150,\n\t// bgheight: 50,\n\ttooltipSVG: tooltipSVG,\n\ttooltipCanvas: tooltipCanvas,\n\torigin: origin,\n\tfill: \"#D4E2FD\",\n\tbgFill: \"#D4E2FD\",\n\tbgOpacity: 0.5,\n\tstroke: \"#9B9BFF\",\n\tfontFill: \"#000000\",\n\topacity: 0.8,\n\tbackgroundShapeSVG: backgroundShapeSVG,\n\tbackgroundShapeCanvas: backgroundShapeCanvas,\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n\tfontSize: 12,\n};\n\nconst PADDING = 5;\nconst X = 10;\nconst Y = 10;\n\n\n/* eslint-disable react/prop-types */\nfunction backgroundShapeSVG({ fill, stroke, opacity }, { height, width }) {\n\treturn <rect\n\t\theight={height}\n\t\twidth={width}\n\t\tfill={fill}\n\t\topacity={opacity}\n\t\tstroke={stroke} />;\n}\n\nfunction tooltipSVG({ fontFamily, fontSize, fontFill }, content) {\n\tconst tspans = [];\n\tconst startY = Y + fontSize * 0.9;\n\n\tfor (let i = 0; i < content.y.length; i++) {\n\t\tconst y = content.y[i];\n\t\tconst textY = startY + (fontSize * (i + 1));\n\n\t\ttspans.push(<tspan key={`L-${i}`} x={X} y={textY} fill={y.stroke}>{y.label}</tspan>);\n\t\ttspans.push(<tspan key={i}>: </tspan>);\n\t\ttspans.push(<tspan key={`V-${i}`}>{y.value}</tspan>);\n\t}\n\treturn <text fontFamily={fontFamily} fontSize={fontSize} fill={fontFill}>\n\t\t<tspan x={X} y={startY}>{content.x}</tspan>\n\t\t{tspans}\n\t</text>;\n}\n/* eslint-enable react/prop-types */\n\nfunction backgroundShapeCanvas(props, { width, height }, ctx) {\n\tconst { fill, stroke, opacity } = props;\n\n\tctx.fillStyle = hexToRGBA(fill, opacity);\n\tctx.strokeStyle = stroke;\n\tctx.beginPath();\n\tctx.rect(0, 0, width, height);\n\tctx.fill();\n\tctx.stroke();\n}\n\nfunction tooltipCanvas({ fontFamily, fontSize, fontFill }, content, ctx) {\n\tconst startY = Y + fontSize * 0.9;\n\tctx.font = `${fontSize}px ${fontFamily}`;\n\tctx.fillStyle = fontFill;\n\tctx.textAlign = \"left\";\n\tctx.fillText(content.x, X, startY);\n\n\tfor (let i = 0; i < content.y.length; i++) {\n\t\tconst y = content.y[i];\n\t\tconst textY = startY + (fontSize * (i + 1));\n\t\tctx.fillStyle = y.stroke || fontFill;\n\t\tctx.fillText(y.label, X, textY);\n\n\t\tctx.fillStyle = fontFill;\n\t\tctx.fillText(\": \" + y.value, X + ctx.measureText(y.label).width, textY);\n\t}\n}\n\nfunction drawOnCanvas(ctx, props, context, pointer, height) {\n\n\tconst { margin, ratio } = context;\n\tconst { bgFill, bgOpacity } = props;\n\tconst { backgroundShapeCanvas, tooltipCanvas } = props;\n\n\tconst originX = 0.5 * ratio + margin.left;\n\tconst originY = 0.5 * ratio + margin.top;\n\n\tctx.save();\n\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.scale(ratio, ratio);\n\n\tctx.translate(originX, originY);\n\n\tconst { x, y, content, centerX, pointWidth, bgSize } = pointer;\n\n\tctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\n\tctx.beginPath();\n\tctx.rect(centerX - pointWidth / 2, 0, pointWidth, height);\n\tctx.fill();\n\n\tctx.translate(x, y);\n\tbackgroundShapeCanvas(props, bgSize, ctx);\n\ttooltipCanvas(props, content, ctx);\n\n\tctx.restore();\n}\n\nfunction calculateTooltipSize({ fontFamily, fontSize, fontFill }, content, ctx) {\n\tif (isNotDefined(ctx)) {\n\t\tconst canvas = document.createElement(\"canvas\");\n\t\tctx = canvas.getContext(\"2d\");\n\t}\n\n\tctx.font = `${fontSize}px ${fontFamily}`;\n\tctx.fillStyle = fontFill;\n\tctx.textAlign = \"left\";\n\n\tconst measureText = str => ({\n\t\twidth: ctx.measureText(str).width,\n\t\theight: fontSize,\n\t});\n\n\tconst { width, height } = content.y\n\t\t.map(({ label, value }) => measureText(`${label}: ${value}`))\n\t\t// Sum all y and x sizes (begin with x label size)\n\t\t.reduce((res, size) => sumSizes(res, size), measureText(String(content.x)))\n\t;\n\n\treturn {\n\t\twidth: width + 2 * X,\n\t\theight: height + 2 * Y\n\t};\n}\n\nfunction sumSizes(...sizes) {\n\treturn {\n\t\twidth: Math.max(...sizes.map(size => size.width)),\n\t\theight: sum(sizes, d => d.height),\n\t};\n}\n\nfunction normalizeX(x, bgSize, pointWidth, width) {\n\t// return x - bgSize.width - pointWidth / 2 - PADDING * 2 < 0\n\treturn x < width / 2\n\t\t? x + pointWidth / 2 + PADDING\n\t\t: x - bgSize.width - pointWidth / 2 - PADDING;\n}\n\nfunction normalizeY(y, bgSize) {\n\treturn y - bgSize.height <= 0\n\t\t? y + PADDING\n\t\t: y - bgSize.height - PADDING;\n}\n\nfunction origin(props, moreProps, bgSize, pointWidth) {\n\tconst { chartId, yAccessor } = props;\n\tconst { mouseXY, xAccessor, currentItem, xScale, chartConfig, width } = moreProps;\n\tlet y = last(mouseXY);\n\n\tconst xValue = xAccessor(currentItem);\n\tlet x = Math.round(xScale(xValue));\n\n\tif (isDefined(chartId) && isDefined(yAccessor)\n\t\t\t&& isDefined(chartConfig) && isDefined(chartConfig.findIndex)) {\n\t\tconst yValue = yAccessor(currentItem);\n\t\tconst chartIndex = chartConfig.findIndex(x => x.id === chartId);\n\n\t\ty = Math.round(chartConfig[chartIndex].yScale(yValue));\n\t}\n\n\tx = normalizeX(x, bgSize, pointWidth, width);\n\ty = normalizeY(y, bgSize);\n\n\treturn [x, y];\n}\n\nfunction helper(props, moreProps, ctx) {\n\tconst { show, xScale, currentItem, plotData } = moreProps;\n\tconst { origin, tooltipContent } = props;\n\tconst { xAccessor, displayXAccessor } = moreProps;\n\n\tif (!show || isNotDefined(currentItem)) return;\n\n\tconst xValue = xAccessor(currentItem);\n\n\tif (!show || isNotDefined(xValue)) return;\n\n\tconst content = tooltipContent({ currentItem, xAccessor: displayXAccessor });\n\tconst centerX = xScale(xValue);\n\tconst pointWidth = Math.abs(xScale(xAccessor(last(plotData))) - xScale(xAccessor(first(plotData)))) / (plotData.length - 1);\n\n\tconst bgSize = calculateTooltipSize(props, content, ctx);\n\n\tconst [x, y] = origin(props, moreProps, bgSize, pointWidth);\n\n\treturn { x, y, content, centerX, pointWidth, bgSize };\n}\n\nexport default HoverTooltip;\n"]}