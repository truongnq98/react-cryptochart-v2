{"version":3,"sources":["../../../src/lib/interactive/FullLine.js"],"names":["FullLine","props","handleEnd","bind","handleDrawChannel","handleDragChannel","handleDragChannelComplete","terminate","saveNodeType","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","trends","newTrends","map","each","idx","x","y","selected","onComplete","current","mouseXY","mouseY","yScale","chartConfig","xAccessor","currentItem","xyValue","invert","e","appearance","type","d","hoverText","tempChannel","eachAppearance","noop","getMouseCanvas","Component","propTypes","PropTypes","oneOf","isRequired","snap","bool","enabled","snapTo","func","shouldDisableSnap","onStart","onSelect","currentPositionStroke","string","currentPositionStrokeWidth","number","currentPositionOpacity","currentPositionRadius","object","array","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStroke","edgeFill","edgeFill2","edgeStrokeWidth","r","defaultProps","button","shiftKey","HoverTextNearMouse","enable","bgHeight","bgWidth","text"],"mappings":"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","file":"FullLine.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, noop } from \"../utils\";\nimport {\n\tterminate,\n\tsaveNodeType,\n\tisHoverForInteractiveType,\n\tgetValueFromOverride,\n} from \"./utils\";\nimport EachFullLine from \"./wrapper/EachFullLine\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getMouseCanvas } from \"../GenericComponent\";\n\nclass FullLine extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleEnd = this.handleEnd.bind(this);\n\t\tthis.handleDrawChannel = this.handleDrawChannel.bind(this);\n\t\tthis.handleDragChannel = this.handleDragChannel.bind(this);\n\t\tthis.handleDragChannelComplete = this.handleDragChannelComplete.bind(this);\n\n\t\tthis.terminate = terminate.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"trends\")\n\t\t\t.bind(this);\n\n\t\tthis.nodes = [];\n\t\tthis.state = {\n\t\t};\n\t}\n\thandleDragChannel(index, newXYValue) {\n\t\tthis.setState({\n\t\t\toverride: {\n\t\t\t\tindex,\n\t\t\t\t...newXYValue\n\t\t\t}\n\t\t});\n\t}\n\thandleDragChannelComplete(moreProps) {\n\t\tconst { override } = this.state;\n\t\tif (isDefined(override)) {\n\t\t\tconst { trends } = this.props;\n\t\t\tconst newTrends = trends\n\t\t\t\t.map((each, idx) => idx === override.index\n\t\t\t\t\t? {\n\t\t\t\t\t\t...each,\n\t\t\t\t\t\tx: override.x,\n\t\t\t\t\t\ty: override.y,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t}\n\t\t\t\t\t: {\n\t\t\t\t\t\t...each,\n\t\t\t\t\t\tselected: false,\n\t\t\t\t\t});\n\n\t\t\tthis.setState({\n\t\t\t\toverride: null,\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newTrends, moreProps);\n\t\t\t});\n\t\t}\n\t}\n\thandleDrawChannel(moreProps) {\n\t\tconst { current } = this.state;\n\t\tif (isDefined(current)) {\n\t\t\tconst {\n\t\t\t\tmouseXY: [, mouseY],\n\t\t\t\tchartConfig: { yScale },\n\t\t\t\txAccessor,\n\t\t\t\tcurrentItem,\n\t\t\t} = moreProps;\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\n\t\t\tthis.setState({\n\t\t\t\tcurrent: {\n\t\t\t\t\tx: xyValue[0],\n\t\t\t\t\ty: xyValue[1],\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\thandleEnd(moreProps, e) {\n\t\tconst { current } = this.state;\n\t\tif (isDefined(current)) {\n\t\t\tconst { trends, appearance, type } = this.props;\n\t\t\tconst {\n\t\t\t\tmouseXY: [, mouseY],\n\t\t\t\tchartConfig: { yScale },\n\t\t\t\txAccessor,\n\t\t\t\tcurrentItem,\n\t\t\t} = moreProps;\n\t\t\tconst xyValue = [xAccessor(currentItem), yScale.invert(mouseY)];\n\t\t\tconst newTrends = [\n\t\t\t\t...trends.map(d => ({ ...d, selected: false })),\n\t\t\t\t{\n\t\t\t\t\tselected: true,\n\t\t\t\t\tx: xyValue[0],\n\t\t\t\t\ty: xyValue[1],\n\t\t\t\t\tappearance,\n\t\t\t\t\ttype,\n\t\t\t\t}\n\t\t\t];\n\t\t\tthis.setState({\n\t\t\t\tcurrent: null,\n\t\t\t\ttrends: newTrends\n\t\t\t}, () => {\n\t\t\t\tthis.props.onComplete(newTrends, moreProps, e);\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst { appearance, trends, hoverText, type,\n\t\t} = this.props;\n\t\tconst { current, override } = this.state;\n\t\tconst tempChannel = isDefined(current) && isDefined(current.x) && isDefined(current.y)\n\t\t\t? <EachFullLine\n\t\t\t\ttype={type}\n\t\t\t\tinteractive={false}\n\t\t\t\t{...current}\n\t\t\t\tappearance={appearance}\n\t\t\t\thoverText={hoverText} />\n\t\t\t: null;\n\t\treturn <g>\n\t\t\t{trends.map((each, idx) => {\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\n\t\t\t\t\t? { ...appearance, ...each.appearance }\n\t\t\t\t\t: appearance;\n\t\t\t\treturn <EachFullLine key={idx}\n\t\t\t\t\ttype={each.type}\n\t\t\t\t\tref={this.saveNodeType(idx)}\n\t\t\t\t\tindex={idx}\n\t\t\t\t\tselected={each.selected}\n\t\t\t\t\thoverText={hoverText}\n\t\t\t\t\tx={getValueFromOverride(override, idx, \"x\", each.x)}\n\t\t\t\t\ty={getValueFromOverride(override, idx, \"y\", each.y)}\n\t\t\t\t\tappearance={eachAppearance}\n\t\t\t\t\tonDrag={this.handleDragChannel}\n\t\t\t\t\tonDragComplete={this.handleDragChannelComplete}\n\t\t\t\t/>;\n\t\t\t})}\n\t\t\t{tempChannel}\n\t\t\t<GenericChartComponent\n\t\t\t\tonClick={this.handleEnd}\n\t\t\t\tonMouseMove={this.handleDrawChannel}\n\t\t\t\tsvgDraw={noop}\n\t\t\t\tcanvasDraw={noop}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\n\t\t\t/>;\n\t\t</g>;\n\t}\n}\n\n\nFullLine.propTypes = {\n\ttype: PropTypes.oneOf([\n\t\t\"VERTICAL\",\n\t\t\"HORIZONTAL\",\n\t]).isRequired,\n\tsnap: PropTypes.bool.isRequired,\n\tenabled: PropTypes.bool.isRequired,\n\tsnapTo: PropTypes.func,\n\tshouldDisableSnap: PropTypes.func.isRequired,\n\n\tonStart: PropTypes.func.isRequired,\n\tonComplete: PropTypes.func.isRequired,\n\tonSelect: PropTypes.func.isRequired,\n\n\tcurrentPositionStroke: PropTypes.string,\n\tcurrentPositionStrokeWidth: PropTypes.number,\n\tcurrentPositionOpacity: PropTypes.number,\n\tcurrentPositionRadius: PropTypes.number,\n\n\thoverText: PropTypes.object.isRequired,\n\ttrends: PropTypes.array.isRequired,\n\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string.isRequired,\n\t\tstrokeOpacity: PropTypes.number.isRequired,\n\t\tstrokeWidth: PropTypes.number.isRequired,\n\t\tfill: PropTypes.string.isRequired,\n\t\tfillOpacity: PropTypes.number.isRequired,\n\t\tedgeStroke: PropTypes.string.isRequired,\n\t\tedgeFill: PropTypes.string.isRequired,\n\t\tedgeFill2: PropTypes.string.isRequired,\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\n\t\tr: PropTypes.number.isRequired,\n\t}).isRequired\n};\n\nFullLine.defaultProps = {\n\ttype: \"VERTICAL\",\n\tonStart: noop,\n\tonComplete: noop,\n\tonSelect: noop,\n\tshouldDisableSnap: e => (e.button === 2 || e.shiftKey),\n\n\tcurrentPositionStroke: \"#000000\",\n\tcurrentPositionOpacity: 1,\n\tcurrentPositionStrokeWidth: 3,\n\tcurrentPositionRadius: 4,\n\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: 18,\n\t\tbgWidth: 90,\n\t\ttext: \"Click to select\",\n\t},\n\ttrends: [],\n\tappearance: {\n\t\tstroke: \"#000000\",\n\t\tstrokeOpacity: 1,\n\t\tstrokeWidth: 1,\n\t\tfill: \"#8AAFE2\",\n\t\tfillOpacity: 0.6,\n\t\tedgeStroke: \"#000000\",\n\t\tedgeFill: \"#FFFFFF\",\n\t\tedgeFill2: \"#250B98\",\n\t\tedgeStrokeWidth: 1,\n\t\tr: 5,\n\t}\n};\n\nexport default FullLine;\n"]}