{"version":3,"sources":["../../../../../src/lib/interactive/wrapper/EachFullLine.js"],"names":["React","Component","PropTypes","isDefined","noop","getXValue","saveNodeType","isHover","ClickableCircle","FullLineComponent","HoverTextNearMouse","FullLine","props","handleLineDrag","bind","handleDragStart","handleChannelDrag","getEdgeCircle","handleHover","nodes","state","hover","moreProps","hovering","setState","x","y","dragStart","index","onDrag","xScale","yScale","chartConfig","xAccessor","fullData","startPos","mouseXY","x1","y1","dx","dy","newX1Value","newY1Value","invert","xy","dragHandler","cursor","fill","edge","appearance","edgeStroke","edgeStrokeWidth","r","selected","onDragComplete","interactive","hoverText","type","edgeFill","stroke","strokeWidth","strokeOpacity","fillOpacity","hoverTextEnabled","enable","restHoverTextProps","hoverHandler","onHover","onUnHover","line1Edge","propTypes","number","isRequired","bool","object","shape","string","edgeFill2","oneOf","func","defaultProps","yDisplayFormat","d","toFixed"],"mappings":"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","file":"EachFullLine.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isDefined, noop } from \"../../utils\";\nimport { getXValue } from \"../../utils/ChartDataUtil\";\nimport { saveNodeType, isHover } from \"../utils\";\n\nimport ClickableCircle from \"../components/ClickableCircle\";\nimport FullLineComponent from \"../components/FullLine\";\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\n\nclass FullLine extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleLineDrag = this.handleLineDrag.bind(this);\n\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\n\t\tthis.handleChannelDrag = this.handleChannelDrag.bind(this);\n\n\t\tthis.getEdgeCircle = this.getEdgeCircle.bind(this);\n\t\tthis.handleHover = this.handleHover.bind(this);\n\n\t\tthis.isHover = isHover.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\t\tthis.nodes = {};\n\n\t\tthis.state = {\n\t\t\thover: false,\n\t\t};\n\t}\n\thandleHover(moreProps) {\n\t\tif (this.state.hover !== moreProps.hovering) {\n\t\t\tthis.setState({\n\t\t\t\thover: moreProps.hovering\n\t\t\t});\n\t\t}\n\t}\n\thandleDragStart() {\n\t\tconst {\n\t\t\tx, y,\n\t\t} = this.props;\n\n\t\tthis.dragStart = {\n\t\t\tx, y,\n\t\t};\n\t}\n\thandleChannelDrag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\n\t\tconst {\n\t\t\tx, y\n\t\t} = this.dragStart;\n\n\t\tconst { xScale, chartConfig: { yScale }, xAccessor, fullData } = moreProps;\n\t\tconst { startPos, mouseXY } = moreProps;\n\n\t\tconst x1 = xScale(x);\n\t\tconst y1 = yScale(y);\n\n\t\tconst dx = startPos[0] - mouseXY[0];\n\t\tconst dy = startPos[1] - mouseXY[1];\n\n\t\tconst newX1Value = getXValue(xScale, xAccessor, [x1 - dx, y1 - dy], fullData);\n\t\tconst newY1Value = yScale.invert(y1 - dy);\n\n\t\tonDrag(index, {\n\t\t\tx: newX1Value,\n\t\t\ty: newY1Value,\n\t\t});\n\t}\n\thandleLineDrag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\t\tconst {\n\t\t\tx, y,\n\t\t} = this.dragStart;\n\n\t\tconst {\n\t\t\tstartPos, mouseXY, xAccessor,\n\t\t\txScale, fullData,\n\t\t\tchartConfig: { yScale }\n\t\t} = moreProps;\n\n\t\tconst dx = startPos[0] - mouseXY[0];\n\t\tconst dy = startPos[1] - mouseXY[1];\n\n\t\tconst x1 = xScale(x);\n\t\tconst y1 = yScale(y);\n\n\t\tconst newX1Value = getXValue(xScale, xAccessor, [x1 - dx, y1 - dy], fullData);\n\t\tconst newY1Value = yScale.invert(y1 - dy);\n\n\t\tonDrag(index, {\n\t\t\tx: newX1Value,\n\t\t\ty: newY1Value,\n\t\t});\n\t}\n\tgetEdgeCircle({ xy, dragHandler, cursor, fill, edge }) {\n\t\tconst { hover } = this.state;\n\t\tconst { appearance } = this.props;\n\t\tconst { edgeStroke, edgeStrokeWidth, r } = appearance;\n\t\tconst { selected } = this.props;\n\t\tconst { onDragComplete } = this.props;\n\n\t\treturn <ClickableCircle\n\t\t\tref={this.saveNodeType(edge)}\n\n\t\t\tshow={selected || hover}\n\t\t\tcx={xy[0]}\n\t\t\tcy={xy[1]}\n\t\t\tr={r}\n\t\t\tfill={fill}\n\t\t\tstroke={edgeStroke}\n\t\t\tstrokeWidth={edgeStrokeWidth}\n\t\t\tinteractiveCursorClass={cursor}\n\n\t\t\tonDragStart={this.handleDragStart}\n\t\t\tonDrag={dragHandler}\n\t\t\tonDragComplete={onDragComplete} />;\n\t}\n\trender() {\n\t\tconst { x, y, interactive, hoverText, appearance, onDragComplete, selected, type } = this.props;\n\t\tconst {\n\t\t\tedgeFill,\n\t\t\tstroke, strokeWidth, strokeOpacity,\n\t\t\tfill, fillOpacity,\n\t\t} = appearance;\n\t\tconst { hover } = this.state;\n\t\tconst { enable: hoverTextEnabled, ...restHoverTextProps } = hoverText;\n\n\t\tconst hoverHandler = interactive\n\t\t\t? { onHover: this.handleHover, onUnHover: this.handleHover }\n\t\t\t: {};\n\n\t\tconst line1Edge = isDefined(x) && isDefined(y)\n\t\t\t? <g>\n\t\t\t\t{this.getEdgeCircle({\n\t\t\t\t\txy: [x, y],\n\t\t\t\t\tdragHandler: this.handleLineDrag,\n\t\t\t\t\tcursor: \"react-stockcharts-move-cursor\",\n\t\t\t\t\tfill: edgeFill,\n\t\t\t\t\tedge: \"fullLineEdge\",\n\t\t\t\t})}\n\t\t\t</g>\n\t\t\t: null;\n\t\treturn <g>\n\t\t\t<FullLineComponent\n\t\t\t\tref={this.saveNodeType(\"fullLine\")}\n\t\t\t\tselected={selected || hover}\n\n\t\t\t\t{...hoverHandler}\n\t\t\t\ttype={type}\n\t\t\t\tstartXY={[x, y]}\n\t\t\t\tstroke={stroke}\n\t\t\t\tstrokeWidth={(hover || selected) ? strokeWidth + 1 : strokeWidth}\n\t\t\t\tstrokeOpacity={strokeOpacity}\n\t\t\t\tfill={fill}\n\t\t\t\tfillOpacity={fillOpacity}\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\n\t\t\t\tonDragStart={this.handleDragStart}\n\t\t\t\tonDrag={this.handleChannelDrag}\n\t\t\t\tonDragComplete={onDragComplete}\n\t\t\t/>\n\t\t\t{line1Edge}\n\t\t\t<HoverTextNearMouse\n\t\t\t\tshow={hoverTextEnabled && hover && !selected}\n\t\t\t\t{...restHoverTextProps} />\n\t\t</g>;\n\t}\n}\n\nFullLine.propTypes = {\n\tx: PropTypes.number.isRequired,\n\ty: PropTypes.number.isRequired,\n\tinteractive: PropTypes.bool.isRequired,\n\tselected: PropTypes.bool.isRequired,\n\thoverText: PropTypes.object.isRequired,\n\tappearance: PropTypes.shape({\n\t\tstroke: PropTypes.string.isRequired,\n\t\tfillOpacity: PropTypes.number.isRequired,\n\t\tstrokeOpacity: PropTypes.number.isRequired,\n\t\tstrokeWidth: PropTypes.number.isRequired,\n\t\tfill: PropTypes.string.isRequired,\n\t\tedgeStroke: PropTypes.string.isRequired,\n\t\tedgeFill: PropTypes.string.isRequired,\n\t\tedgeFill2: PropTypes.string.isRequired,\n\t\tedgeStrokeWidth: PropTypes.number.isRequired,\n\t\tr: PropTypes.number.isRequired,\n\t}).isRequired,\n\ttype: PropTypes.oneOf([\n\t\t\"VERTICAL\",\n\t\t\"HORIZONTAL\",\n\t]).isRequired,\n\tindex: PropTypes.number,\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n};\n\nFullLine.defaultProps = {\n\tyDisplayFormat: d => d.toFixed(2),\n\tinteractive: true,\n\tselected: false,\n\n\tonDrag: noop,\n\tonDragComplete: noop,\n\thoverText: {\n\t\tenable: false,\n\t}\n};\n\nexport default FullLine;"]}